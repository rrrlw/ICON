---
title: Exploring complex networks with the `ICON` R package
authors:
  - name: Raoul R. Wadhwa
    department: Cleveland Clinic Lerner College of Medicine
    affiliation: Case Western Reserve University
    location: Cleveland, OH 44195
    email: raoul.wadhwa@case.edu
  - name: Jacob G. Scott
    department: Translational Hematology \& Oncology Research
    affiliation: Lerner Research Institute, Cleveland Clinic
    location: Cleveland, OH 44195
    email: ScottJ10@ccf.org
abstract: |
  We introduce `ICON`, an R package that contains `r nrow(ICON::ICON_data)` complex network datasets in a standard edgelist format.
  All provided datasets have associated citations and have been indexed by the Colorado Index of Complex Networks - also referred to as ICON.
  In addition to supplying a large and diverse corpus of useful real-world networks, `ICON` also implements an S3 generic to work with the `network` and `ggnetwork` R packages for network analysis and visualization, respectively.
  Sample code in this report also demonstrates how `ICON` can be used in conjunction with the `igraph` package.
  Currently on version $0.4.0$, `ICON` has been accepted by the Comprehensive R Archive Network.
  It is our hope that `ICON` will serve as a standard corpus for complex network research and prevent redundant work that would be otherwise necessary by individual research groups.
  The open source code for `ICON` and for this reproducible report can be found at \url{https://github.com/rrrlw/ICON}.
keywords:
  - complex networks
  - R programming language
bibliography: ICONrefs.bib
nocite: |
  @rpkg-book
csl: num_style.csl
output: rticles::arxiv_article
---

# Introduction

Empirical study of complex networks requires real-world data to validate theoretical results.
A large, diverse corpus of networks often proves useful given the many shapes and sizes that complex networks assume.[@corpus1;@corpus2]
To our knowledge, the [Colorado Index of Complex Networks (ICON)](https://icon.colorado.edu) hosts the largest curated index of real-world complex networks, with metadata and links to over 5,000 networks as of this writing.[@icon]
However, heterogeneity in data format, access, and availability limit how easily users can take advantage of this incredible resource.
A central repository containing a large corpus of ICON-indexed networks in standard format would thus provide a useful service for network science researchers, who would avoid the tedious task of data format conversion prior to analysis.
Here, we introduce the `ICON` R package as such a solution, providing a large and diverse corpus of real-world networks and tools to work with existing network analysis and visualization R packages.

# Implementation details

\texttt{ICON} v$0.4.0$ is a package for the R programming language hosted on the Comprehensive R Archive Network (CRAN).[@rlang]
It strongly depends on the `network` ($\geq 1.16$) and `utils` ($\geq 3.6.1$) R packages and weakly depends on the `covr` ($\geq 3.5$), `ggnetwork` ($\geq 0.5$), `ggplot2` ($\geq 3.3$), `knitr` ($\geq 1.30$), `testthat` ($\geq 2.3$), and `rmarkdown` ($\geq 2.4$) R packages.[@rlang;@network-pkg;@covr-pkg;@ggnetwork-pkg;@ggplot2-pkg;@knitr-pkg;@testthat-pkg;@rmarkdown-pkg]
Throughout the development process, the `devtools` R package was heavily used.[@devtools-pkg]
This report is fully reproducible with code (GPL-3 license) available at \url{https://github.com/rrrlw/ICON}.
Full reproduction will require installation of the strong and weak dependencies listed above.

## Installation

The stable version of `ICON` (currently v$0.4.0$) can be downloaded from CRAN, while the development version can be downloaded from the package's [GitHub repository](https://github.com/rrrlw/ICON) using the `remotes` package.[@remotes-pkg]
Both options are demonstrated in the following code chunk.

```{r install, eval=FALSE}
# install stable version from CRAN
install.packages("ICON")

# install development version from GitHub
remotes::install_github("rrrlw/ICON", build_vignettes = TRUE)
```

## Complex network datasets

```{r calc-prep, echo=FALSE, message=FALSE, results='hide'}
library("ICON")
data("ICON_data")

largest_row <- which(ICON_data$Edges == max(ICON_data$Edges))
```

Currently, `ICON` provides `r nrow(ICON::ICON_data)` complex network edge lists.
The largest network, named ``r ICON_data$Var_name[largest_row]``, consists of `r ICON_data$Edges[largest_row]` edges.
Due to the large volume of data and CRAN package size limits, all of `ICON`'s networks cannot be downloaded to a local machine upon installation and loaded with `utils::data`.
Instead, the package's GitHub repository contains a directory named `data-host`, which `ICON::get_data` accesses to download networks named by the user.
After successful download, `ICON::get_data` loads these networks into the user's environment of choice (default: `.GlobalEnv`) and cleans any intermediate artifacts.
To avoid dependence on an internet connection, users can save and access individual networks in RDS format (binary; `.rds` extension; via `base::saveRDS` and `base::readRDS`) or do the same for a set of networks in RData/RDa format (binary; `.RData` or `.rda` extension; via `base::save` and `base::load`).
An obvious deficiency of this system is the inability to take advantage of automated data documentation and checking tools, such as `roxygen2`.[@roxygen2-pkg]
However, the `ICON::ICON_data` dataset provides the necessary documentation for `ICON` users and implements a sufficient and slightly soporific checking system for the package authors.

Although providing standardized data format avoids redundant work, an important processing step being completed by a single party (package authors) opens the door to inaccuracies.
It befits us to simply counter this limitation with `ICON`'s status as free, open-source software (FOSS), which offers every user the opportunity to inspect, question, and correct all aspects of `ICON`.
The `data-raw` directory in `ICON`'s GitHub repository follows Wickham's (2015) advice and contains: (1) the original raw data acquired directly from the source indexed by the ICON website; (2) the R code that converts each raw dataset into a data frame comprised of an edge list and potential edge attributes; and (3) the R code saving the resulting data frame as an RDA file in the aforementioned `data-host` directory.
We hope that this not only offers, but indeed encourages, `ICON` users to confirm dataset accuracy.

Note that to minimize unnecessary package elements, `ICON`'s `.Rbuildignore` contains `data-host` and `data-raw`.
However, for reproducibility and documentation, `ICON`'s GitHub repository provides public access to both directories.

We will now look at sample code to acquire complex network datasets using `ICON`.
To do so, we must load the library in the R session and load the `ICON_data` dataset, which contains relevant complex network metadata.
The metadata can be explored in the package documentation with `?ICON_data`; in this report, we will focus only on the essentials, starting with the following code chunk.

```{r sample-load}
# load library
library("ICON")

# load metadata
# explore this data frame to figure out which networks suit your needs
data("ICON_data")

# peek at the first few and last few packages available to download
head(ICON_data$Var_name, n = 3)

tail(ICON_data$Var_name, n = 3)
```

We first try downloading a single dataset with `ICON::get_data` and peeking at its contents.
Once this succeeds, we confidently download multiple datasets.

```{r sample}
# download single dataset named in previous code chunk output
# could also use `get_data(ICON_data$Var_name[1])` to same effect
get_data("aishihik_intensity")

# look at the structure of the complex network
str(aishihik_intensity)

# confirm that metadata reflects the correct number of edges
(ICON_data$Edges[1] == nrow(aishihik_intensity))

# look at the first few rows; for all ICON datasets:
#   columns 1 and 2 = nodes that define the edge
#   columns 3 and beyond = edge attributes (e.g. weight)
head(aishihik_intensity)

# download multiple datasets
get_data(c("wordadj_japanese", "wordadj_french"))

# confirm downloads by looking at internal structure
str(wordadj_japanese)

str(wordadj_french)
```

A keen reader might observe that all of `ICON`'s datasets could be downloaded with `get_data(ICON_data$Var_name)`; due to the potential runtime and memory commitment, we strongly recommend that users exercise caution if attempting this.

## The ICON class and network S3 generic

Looking at the structure of the complex networks with `utils::str` shows that `ICON` complex networks all have two classes: `ICON` and `data.frame`.
The latter provides a suitable container for edge list objects with potential edge attributes in rectangular format.
The former, an S3 class, benefits users in two ways.
First, it provides certain guarantees about object format, i.e., an unmodified complex network object acquired via `ICON` will have the `ICON` S3 class and is guaranteed to be a data frame containing an edge list in which each row represents a single edge, the first two columns specify nodes that define the corresponding edge, and additional columns define edge attributes.
This standard format guarantee allows users, among other things, to generate code for one `ICON` dataset with assurances that it will function effectively for other `ICON` datasets.
Second, the S3 class allows users to take advantage of relevant S3 generics.
`ICON` specifically defines the `as.network.ICON` method for compatibility with the `as.network` generic in the `network` R package.
This allows users to easily analyze and visualize `ICON` datasets with the reliable `network` and `ggnetwork` R packages, respectively.
Section \ref{networkusecase} will provide sample code that highlights the benefit of this feature.

# Use cases

Before starting with the use cases, the following code chunk will load the appropriate libraries and download the sample dataset.

```{r use-setup,message=FALSE,results='hide'}
# load necessary libraries
library("ICON")
library("network")
library("ggnetwork")
library("ggplot2")
library("igraph")

# download sample dataset
get_data("seed_disperse_beehler")
```

## With the \texttt{network} R package {#networkusecase}

---

```{r network-case,message=FALSE,results='hide',fig.width=3,fig.height=3}
# setup using as.network generic
coerced <- as.network(seed_disperse_beehler)

# plot with ggnetwork
ggplot(coerced, aes(x = x, y = y, xend = xend, yend = yend)) +
  geom_edges(alpha = 0.25) +
  geom_nodes() +
  theme_blank()
```

## With the \texttt{igraph} R package

```{r igraph-case,message=FALSE,results='hide',fig.width=4,fig.height=4}
# plot network using igraph
my_graph <- graph_from_edgelist(as.matrix(seed_disperse_beehler[, 1:2]),
                                directed = FALSE)
plot(my_graph,
     vertex.label = NA, vertex.size = 5)
```

# Discussion/Conclusions

* encourage users to contribute complex network datasets via CONTIBUTING.md and CODE_OF_CONDUCT.md (Contributor Covenant)

# References
